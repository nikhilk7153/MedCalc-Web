<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FeverPAIN Score</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./static/css/calculator.css">
</head>
<body class="bg-slate-100 min-h-screen py-10 px-4">
    <div class="calculator-shell mx-auto w-full max-w-4xl space-y-10">
        <header class="page-hero">
            <div class="hero-pills">
                <span class="badge badge--outline">Benchmark mode</span>
                <span class="badge badge--neutral">FeverPAIN</span>
            </div>
            <h1 class="page-title">F-E-V-E-R Timeline</h1>
            <p class="page-subtitle">
                Walk across the mnemonic strip. Flip the switches only when the finding is explicitly documented.
            </p>
            <div class="hero-metadata">
                <div><p class="meta-label">Inputs</p><p class="meta-value">5 checkpoints</p></div>
                <div><p class="meta-label">Output</p><p class="meta-value">0–5 score</p></div>
                <div><p class="meta-label">Use</p><p class="meta-value">Strep risk triage</p></div>
            </div>
        </header>

        <form id="feverpain-form" class="stacked-form" novalidate>
            <div id="error-message" class="hidden callout callout-error">
                <div class="callout-header">
                    <span id="error-text">Toggle the findings observed in the patient.</span>
                </div>
            </div>

            <ol class="stepper">
                <li class="step-card">
                    <div class="step-header">
                        <span class="step-index">F</span>
                        <div>
                            <h3>Fever 24 h</h3>
                            <p class="helper-text">Objectively measured temp ≥ 38°C or documented fever.</p>
                        </div>
                    </div>
                    <label class="option-pill mt-4">
                        <input type="checkbox" id="fever">
                        <span>Fever within the past day</span>
                    </label>
                </li>
                <li class="step-card">
                    <div class="step-header">
                        <span class="step-index">E</span>
                        <div>
                            <h3>Exudate/purulence</h3>
                            <p class="helper-text">Either purulent tonsils or marked tonsillar erythema.</p>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-3 mt-4">
                        <label class="option-pill">
                            <input type="checkbox" id="purulent-tonsils">
                            <span>Purulent tonsils</span>
                        </label>
                        <label class="option-pill">
                            <input type="checkbox" id="tonsil-inflammation">
                            <span>Severe tonsil inflammation</span>
                        </label>
                    </div>
                </li>
                <li class="step-card">
                    <div class="step-header">
                        <span class="step-index">V</span>
                        <div>
                            <h3>Very rapid onset</h3>
                            <p class="helper-text">Symptoms began ≤ 3 days prior to presentation.</p>
                        </div>
                    </div>
                    <label class="option-pill mt-4">
                        <input type="checkbox" id="symptom-onset">
                        <span>Onset ≤ 72 hours</span>
                    </label>
                </li>
                <li class="step-card">
                    <div class="step-header">
                        <span class="step-index">E</span>
                        <div>
                            <h3>Ent symptoms lacking</h3>
                            <p class="helper-text">Absence of cough or coryza.</p>
                        </div>
                    </div>
                    <label class="option-pill mt-4">
                        <input type="checkbox" id="cough-absent">
                        <span>No cough/coryza noted</span>
                    </label>
                </li>
                <li class="step-card">
                    <div class="step-header">
                        <span class="step-index">R</span>
                        <div>
                            <h3>Recent feverish exposure</h3>
                            <p class="helper-text">Subjective feverishness or close contact with febrile illness.</p>
                        </div>
                    </div>
                    <label class="option-pill mt-4">
                        <input type="checkbox" id="fever-secondary">
                        <span>Subjective fever/contact</span>
                    </label>
                </li>
            </ol>

            <p class="helper-text text-center">Score 1 point for every confirmed item. Leave unchecked if the chart is silent.</p>

            <div class="form-actions">
                <button id="calculate-btn" type="submit" class="primary-button" data-label="Calculate FeverPAIN">
                    Calculate FeverPAIN
                </button>
            </div>
        </form>

        <section id="result-container" class="result-panel hidden">
            <div class="result-header">
                <p class="badge badge--neutral">FeverPAIN</p>
                <h2>Score</h2>
            </div>
            <div class="result-value">
                <span class="result-unit">points</span>
                <p id="result-value">—</p>
            </div>
            <details id="result-explanation-panel" class="result-details hidden">
                <summary>View explanation</summary>
                <pre id="result-explanation" class="whitespace-pre-wrap"></pre>
            </details>
        </section>
    </div>

    <script src="./static/js/calculator-page.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const apiBase = (window.CALCULATOR_API_BASE || '').replace(/\/$/, '');

            const collectPayload = () => ({
                'Fever in past 24 hours': document.getElementById('fever').checked,
                'Absence of cough or coryza': document.getElementById('cough-absent').checked,
                'Symptom onset <=3 days': document.getElementById('symptom-onset').checked,
                'Purulent tonsils': document.getElementById('purulent-tonsils').checked,
                'Severe tonsil inflammation': document.getElementById('tonsil-inflammation').checked,
                'Subjective fever/contact': document.getElementById('fever-secondary').checked,
            });

            const renderResult = (result) => {
                const value = result.answer ?? result.raw_score ?? result.score;
                document.getElementById('result-value').textContent =
                    value === null || typeof value === 'undefined' ? '—' : value;
                if (result.explanation) {
                    document.getElementById('result-explanation').textContent = result.explanation;
                    document.getElementById('result-explanation-panel').classList.remove('hidden');
                } else {
                    document.getElementById('result-explanation-panel').classList.add('hidden');
                }
                document.getElementById('result-container').classList.remove('hidden');
            };

            CalculatorPage.init({
                formId: 'feverpain-form',
                submitButtonId: 'calculate-btn',
                errorBoxId: 'error-message',
                errorTextId: 'error-text',
                apiBase,
                slug: 'feverpain-score-for-strep-pharyngitis',
                collectPayload,
                onResult: renderResult,
            });
        });
    </script>
</body>
</html>

